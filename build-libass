#!/usr/bin/env bash -e
#
# libass
# https://github.com/libass/libass.git
#
cd "$(dirname "$0")"
set -a; source build.env; set +a

pkgname="libass"
pkgdir="${STOWDIR}/${pkgname}"
srcdir="src/libass"

export CFLAGS="${CFLAGS} -O3 -flto=thin"

cd "${srcdir}"

./autogen.sh

./configure \
  --prefix="${pkgdir}" \
  --enable-shared \
  --disable-static \
  --disable-dependency-tracking \
  --enable-coretext \
  --enable-libunibreak \
  --enable-asm \
  --disable-fontconfig \
  "$@"

make -j4

rm -rf "${pkgdir}"

make install
stow -Rd "${STOWDIR}" "${pkgname}"

# vi:set ts=2 sw=2 et:
